---
title: "InitialAnalysis_RPXErosionModeling"
author: "Omprakash Samudrala"
date: "April 17, 2018"
output: html_document
---

## Initial Analysis

Dataset for the analysis titled **ModelDataSet** was added to the data folder of the project

Data Sets contains 6 parameters (columns) - 5 of which are predictors (Mean Process Flow, Std Deviation Process Flow, Mean Motive Flow, Std Dev Motive Flow, number of RPXs running) and 1 response variable (Erosion Potential)

Objectives

* Read data, randomize and split it into 3 sets - **training** data set, **validation** data set and **test** data set
* Plot the predictors and response variable
* Try a naive model - mean of the response variable across the training data set
* Determine how well does the model do to predict the response - mean absolute deviation of the response variable from actual response
* Figure out if the success metric is achieved (mean absolute deviation < 0.05)

```{r echo=FALSE}
# Read Data
getwd()
setwd("C:/Users/ompra/Documents/UCBCourses/DataScience/project/RPXFlows/data")
library(openxlsx)
TData <- read.xlsx("ModelDataSet.xlsx")
nRows <- nrow(TData)

#Shuffle Data
SData <- TData[sample(nrow(TData)),]
str(SData)
summary(SData)

#Split Shuffled Data into training data, validation data & test data
TrgData <- SData[1:(0.6*nrow(SData)),]
ValData <- SData[(0.6*nrow(SData)):(0.8*nrow(SData)),]
TstData <- SData[(0.8*nrow(SData)):nrow(SData),]

#Build histogram of response variable - Erosion Potential
library(ggplot2)
ggplot(data=TrgData,aes(x=ErosionPotential)) +
   geom_histogram(binwidth=0.1,fill="Magenta",color="Black")

#Build histograms of the five predictors
ggplot(data=TrgData,aes(x=MeanProcFlow)) +
  geom_histogram(binwidth=20,fill="Blue",color="Black")

ggplot(data=TrgData,aes(x=StDevProcFlow)) +
  geom_histogram(binwidth=2,fill="Green",color="Black")

ggplot(data=TrgData,aes(x=MeanMotFlow)) +
  geom_histogram(binwidth=20,fill="Blue",color="Black")

ggplot(data=TrgData,aes(x=StDevMotFlow)) +
  geom_histogram(binwidth=2,fill="Green",color="Black")

ggplot(data=TrgData,aes(x=numRPX)) +
  geom_histogram(binwidth=1,fill="Brown",color="Black")

#Build a Naive Model to predict Erosion Potential
#Take the mean
ErPot_Naive = mean(TrgData$ErosionPotential)
TrgData$NaiveResponse = c(rep(ErPot_Naive,nrow(TrgData)))

#Check mean absolute deviation if the model is good
TrgData$AbsDeviationNaive = abs(TrgData$ErosionPotential - TrgData$NaiveResponse)
MeanAbsDeviationNaive = mean(TrgData$AbsDeviationNaive)
MeanAbsDeviationNaive
```


The mean absolute deviation obtained from the naive model was **`r MeanAbsDeviationNaive`**. Hence it does not meet the success metric of **< 0.05**

On to other models .....

The next set of plots show how the actual response variable and the naive response prediction with respect to each of the predictors.


```{r echo=FALSE}
#Plot actual response and naive model response vs each of the 5 input variables

ggplot(data = TrgData) +
  geom_point(aes(x = MeanProcFlow, y = NaiveResponse),size=5,color="DarkGreen") +
  geom_point(aes(x = MeanProcFlow, y = ErosionPotential)) + 
  xlab("Process Flow across RPXs - Mean Flow (GPM)") +
  ylab("Erosion Potential")
  
ggplot(data = TrgData) +
  geom_point(aes(x = StDevProcFlow, y = NaiveResponse),size=5,color="DarkGreen") +
  geom_point(aes(x = StDevProcFlow, y = ErosionPotential)) + 
  xlab("Process Flow across RPXs - Standard Deviation (GPM)") +
  ylab("Erosion Potential")

ggplot(data = TrgData) +
  geom_point(aes(x = MeanMotFlow, y = NaiveResponse),size=5,color="DarkGreen") +
  geom_point(aes(x = MeanMotFlow, y = ErosionPotential)) + 
  xlab("Motive Flow across RPXs - Mean Flow (GPM)") +
  ylab("Erosion Potential")

ggplot(data = TrgData) +
  geom_point(aes(x = StDevMotFlow, y = NaiveResponse),size=5,color="DarkGreen") +
  geom_point(aes(x = StDevMotFlow, y = ErosionPotential)) + 
  xlab("Motive Flow across RPXs - Standard Deviation (GPM)") +
  ylab("Erosion Potential")

ggplot(data = TrgData) +
  geom_point(aes(x = numRPX, y = NaiveResponse),size=5,color="DarkGreen") +
  geom_point(aes(x = numRPX, y = ErosionPotential)) + 
  xlab("number of RPXs running") +
  ylab("Erosion Potential")
```

